# Architecture Governance

This directory is the single source of truth for the SOLID/Clean Architecture effort.
Artifacts here back up automated guardrails, capture migration status, and enable
new engineers to contribute safely.

## Layer Overview

- **Domain** – Business rules, entities, value objects, pure services. Framework-free.
- **Application** – Use-case orchestration, ports, DTOs, domain policy translation.
- **Adapters** – HTTP controllers, presenters, background jobs, UI façades.
- **Infrastructure** – Persistence, messaging, caching, observability implementations.

See `inversion-of-control.md` for detailed dependency and injection rules.

## Mandatory Guardrails

- Dependency arrows must always point inward toward the domain.
- Outer layers interact with inner layers via interfaces (`src/application/ports/**`).
- `dependency-cruiser` configuration (`config/architecture-rules.json`) enforces:
  - Domain cannot import application/adapters/infrastructure.
  - Application cannot import adapters/infrastructure.
  - Core layers cannot import `src/lib` helpers directly.
- Use `tests-support/architecture-test-utils.ts#assertCleanArchitecture` inside tests.

### Running Checks Locally

```bash
yarn test:arch                     # dependency graph guardrails
yarn test:integration --grep=architecture  # contract suites for internal APIs
```

## Living Artifacts

- `use-cases.md` – Catalogue of critical flows with coverage status.
- `map.md` – Architecture dependency snapshot generated by `generate-map.ts`.
- `inversion-of-control.md` – IoC rules and validation checklist.
- `migration-backlog.md` – Outstanding service migrations with owners.
- `waivers.md` – Temporary dependency exceptions with expiry dates.
- `audit-log.md` – Quickstart + onboarding run history.

## Contribution Workflow

1. Review outstanding items in `migration-backlog.md`.
2. Run `yarn test:arch` and relevant integration suites before submitting PRs.
3. Update documentation in this folder when introducing new ports, adapters,
   or refactoring migration scope.
4. Log onboarding/quickstart verification in `audit-log.md` when completed.

## Contacts

- Architecture strike team: `#proj-architecture-refactor`
- Governance owner: `@tech-lead-architecture`
- Documentation steward: `@devrel`
